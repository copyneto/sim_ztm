sap.ui.define([                                                                                                                                                                                                                                                
    "sap/m/MessageToast",                                                                                                                                                                                                                                      
    "sap/m/PDFViewer",                                                                                                                                                                                                                                         
    "sap/ui/model/Filter"                                                                                                                                                                                                                                      
], function(MessageToast, PDFViewer, Filter) {                                                                                                                                                                                                                 
    'use strict';                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
    return {                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                                               
        onBeforeRendering: function () {                                                                                                                                                                                                                       
            this.getView().byId(this.byId("onRomaneioButton").getId()).setIcon("sap-icon://pdf-attachment");                                                                                                                                                   
        },                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
        getPDFData: function (oEvent) {                                                                                                                                                                                                                        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                             
            let aFilter = [];                                                                                                                                                                                                                                  
            let oExtApi = this.templateBaseExtension.getExtensionAPI();                                                                                                                                                                                        
            // get the Model reference                                                                                                                                                                                                                         
            var oModel = this.getView().getModel();                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
            let oCtx = this.templateBaseExtension.getExtensionAPI().getSelectedContexts();                                                                                                                                                                     
                                                                                                                                                                                                                                                               
            for (let oCtx of oExtApi.getSelectedContexts()){                                                                                                                                                                                                   
                aFilter.push(new Filter("docnum", "EQ", oCtx.getObject().docnum));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                         
            }                                                                                                                                                                                                                                                  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                       
            return new Promise((resolve, reject) => {                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
                // Perform Read operation and pass billingdoc as parameter to URL                                                                                                                                                                              
                oModel.read("/PDF", {                                                                                                                                                                                                                          
                    filters: aFilter,                                                                                                                                                                                                                          
                    success: function (oData, oResponse) {                                                                                                                                                                                                     
                        resolve(oData);                                                                                                                                                                                                                        
                    },                                                                                                                                                                                                                                         
                    error: function (oError) {                                                                                                                                                                                                                 
                        reject(oError);                                                                                                                                                                                                                        
                    }                                                                                                                                                                                                                                          
                });                                                                                                                                                                                                                                            
            })                                                                                                                                                                                                                                                 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                       
        },                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
        romaneio: async function (oEvent) {                                                                                                                                                                                                                    
            var that = this;                                                                                                                                                                                                                                   
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                       
            var opdfViewer = new PDFViewer();                                                                                                                                                                                                                  
            that.getView().addDependent(opdfViewer);                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
            var vPDF = await that.getPDFData(oEvent);                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
            if (vPDF === '') {                                                                                                                                                                                                                                 
                MessageBox.error("Erro ao gerar PDF")                                                                                                                                                                                                          
                return;                                                                                                                                                                                                                                        
            }                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
            let base64EncodedPDF = vPDF.results[0].stream_data;                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
            let decodedPdfContent = atob(base64EncodedPDF);                                                                                                                                                                                                    
            let byteArray = new Uint8Array(decodedPdfContent.length);                                                                                                                                                                                          
            for (var i = 0; i < decodedPdfContent.length; i++) {                                                                                                                                                                                               
                byteArray[i] = decodedPdfContent.charCodeAt(i);                                                                                                                                                                                                
            }                                                                                                                                                                                                                                                  
            var blob = new Blob([byteArray.buffer], {                                                                                                                                                                                                          
                type: 'application/pdf'                                                                                                                                                                                                                        
            });                                                                                                                                                                                                                                                
            var pdfurl = URL.createObjectURL(blob);                                                                                                                                                                                                            
            jQuery.sap.addUrlWhitelist("blob"); // register blob url as whitelist                                                                                                                                                                              
            opdfViewer.setSource(pdfurl);                                                                                                                                                                                                                      
            opdfViewer.setVisible(true);                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
            opdfViewer.setTitle("Minuta de Faturamento");                                                                                                                                                                                                      
            opdfViewer.open();                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                                      
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                             
    };                                                                                                                                                                                                                                                         
});                                                                                                                                                                                                                                                            